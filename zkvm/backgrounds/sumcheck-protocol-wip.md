# Sumcheck Protocol(wip)

## モチベーション

ランダムな点での検証が計算全体を完全に再計算するよりもはるかに少ないコストで正確性を高確率で保証したい。

これを直接行う場合は多変数多項式の各変数に対して {0, 1} のすべての組み合わせで評価を行う必要があり、たとえば、$\ell$個の変数があると、評価する項数は \[$ 2^\ell ]l となり、検証コストが指数的に増加する



## アイデア

以下の工夫を持って効率化させることができる

1. &#x20;1次多項式の評価に変換する

Sum-Checkプロトコルでは、各ラウンドでの多項式は1次多項式として構成される。この1次多項式を評価するコストは、総和を直接計算する場合と比べて非常に低く、線形時間で処理できる。&#x20;

2. 再帰的に計算する

各ラウンドで1つずつ変数を固定していき、ランダムな点での評価を進めることで、1つの変数についてランダムにチェックし次の変数に進む。これにより多項式全体の正しさを少ない回数のチェックで保証することが可能になる



証明者はある多変数多項式gを各変数ごと分割してsumを計算し、その過程で得られた部分合計を検証者に提示する。 検証者は、証明者が提示した部分合計に対してランダムなポイントを選び、そのポイントに対する多項式の値が正しいかを確認する。このステップを全ての変数に対して行うことで、元々の多変数多項式の合計が検証できる。 最終的に得られる合計値Hは以下のように表現される。



$$
H := \sum_{b_1 \in {0,1}} \sum_{b_2 \in {0,1}} \dots \sum_{b_\ell \in {0,1}} g(b_1, \dots)
$$

## 仕組み

ここでは各変数がbooleanをとっているように、先述のMLEにおける検証プロトコルを使っている。 全体としては以下のようになっている。&#x20;

<figure><img src="../../.gitbook/assets/image (1) (1).png" alt=""><figcaption></figcaption></figure>

ぱっと見では分かりづらいので、例を持って示す。



例として\[$ g=(x,y,z)=2x^3+xz+yz]というHypercubeが有限体上にある時このsumはH(=12)と等価になることを検証する

> このように3変数からなるbinary hypercubeを応用したzerocheck protocolをhyperplonkでは採用している まずは、最初の変数xについてみていく。 \[$ g(x,0,0)+g(x,0,1)+g(x,1,0)+g(x,1,1)] \[$ = (2x^3)+(2x^3+x)+(2x^3)+(2x^3+x+1)] \[$ = (8x^3)+2x+1] ここで、gをベースとした単変数多項式(sum)\[$ s]を\[$ s\_0(x)= (8x^3)+2x+1]とおく。 証明者はこの\[$ s\_0]を検証者に送り、検証者は\[$ s\_0(0)+s\_0(1)=12]となることを確認する。

次にyのsumcheckを実行する。

検証者はランダムな値\[$ r\_1]を選択し、証明者に\[$ s\_1]におけるxの値として使わせる。ここでは\[$ r\_1=2] とする。

> ラウンド1ではランダムチェックは実行できないことに注意 証明者は以下の\[$ s\_1]を構築する \[$ s\_1(y)=g(2,y,0)+g(2,y,1)=16+(16+2+y)=34+y] そしてこの\[$ s\_1]を検証者に送り、検証者は\[$ r\_1]とyで以下の式を検証する

$$
s_1(0)+s_1(1)=s_0(r_1)
$$





> 右辺の\[$ s\_0]に関しては前のラウンドですでに証明者から送られている

\[$ b\_2,,,b\_{v-1}]までのラウンドについてこの方式でsumcheckしていく

最終ラウンドvでは最後の変数まで進んで、多項式の全体の正しさを証明する。 検証者は g(r\_0, r\_1, r\_2) という形で評価を行い、その結果が前のラウンドの s\_2(r\_3) と一致していることを確認する。 ここでの確認が成り立てば、検証者は前のラウンドからの全ての計算結果が正しかったことを確信できる

プロトコル全体をまとめると以下のようになる

```
ラウンド1:
 x_1  に対して部分和  S_1(x_1)  を計算。
	検証者はランダムなサンプル  r_1  を選び、次のラウンドに進む。
ラウンド2:
 x_2  に対して部分和  S_2(x_2)  を計算（ただし、前のラウンドで選ばれた  r_1  を使用）。
	検証者はランダムなサンプル  r_2  を選び、次のラウンドに進む。
ラウンド3:
 x_3  に対して部分和  S_3(x_3)  を計算し、最終的な総和を確認。
```

## 参考

[https://people.cs.georgetown.edu/jthaler/sumcheck.pdf](https://people.cs.georgetown.edu/jthaler/sumcheck.pdf)\
\
[https://www.youtube.com/watch?v=gfy8rotcas4](https://www.youtube.com/watch?v=gfy8rotcas4)
